<!DOCTYPE html>
<html>
  <head>
    <title>Google Drive Upload</title>
    <script src="https://apis.google.com/js/api.js"></script>
  </head>
  <body>
    <h2>Upload File to Google Drive</h2>
    <button onclick="handleAuthClick()">Sign in with Google</button>
    <input type="file" id="fileInput">
    <button onclick="uploadFile()">Upload</button>

    <script>
      const CLIENT_ID = '347410332768-elvor0mtrlmbttpr0stqrfduq448i7sl.apps.googleusercontent.com'; // paste from your JSON
      const API_KEY = 'AIzaSyA4vk0smXEXMBDQ55dlBVp3JpBkNDRRzsw';     // create from Credentials page
      const SCOPES = 'https://www.googleapis.com/auth/drive.file';

      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }

      function initClient() {
        gapi.client.init({
          apiKey: API_KEY,
          clientId: CLIENT_ID,
          discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],
          scope: SCOPES,
        });
      }

      function handleAuthClick() {
        gapi.auth2.getAuthInstance().signIn().then(() => {
          alert('Signed in!');
        });
      }

      function uploadFile() {
        const file = document.getElementById('fileInput').files[0];
        const metadata = {
          name: file.name,
          mimeType: file.type,
        };

        const accessToken = gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token;
        const form = new FormData();
        form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
        form.append('file', file);

        fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
          method: 'POST',
          headers: new Headers({ 'Authorization': 'Bearer ' + accessToken }),
          body: form,
        })
          .then(response => response.json())
          .then(data => {
            alert('File uploaded! File ID: ' + data.id);
          });
      }

      // Load gapi client on page load
      window.onload = handleClientLoad;
    </script>
  </body>
</html>
