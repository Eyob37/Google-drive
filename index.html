<!DOCTYPE html>
<html>
<head>
    <title>Google Drive API Example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
    <button id="authorize_button">Authorize</button>
    <button id="signout_button" style="display:none;">Sign Out</button>
    <pre id="content"></pre>

    <script>
        const CLIENT_ID = '347410332768-elvor0mtrlmbttpr0stqrfduq448i7sl.apps.googleusercontent.com'; 
        const API_KEY = 'AIzaSyDWGDCy-4-31EmlYiIwrfpwoDAAjrdzvfc';  // Optional for simple listing
        const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest';
        const SCOPES = 'https://www.googleapis.com/auth/drive.metadata.readonly';

        let tokenClient;
        let gapiInited = false;
        let gisInited = false;

        document.getElementById('authorize_button').onclick = handleAuthClick;
        document.getElementById('signout_button').onclick = handleSignoutClick;

        // On load, load the gapi client
        gapi.load('client', initClient);

        function initClient() {
            gapi.client.init({
                apiKey: API_KEY,
                discoveryDocs: [DISCOVERY_DOC],
            }).then(function () {
                gapiInited = true;
            }, function(error) {
                appendPre(JSON.stringify(error, null, 2));
            });
        }

        function handleAuthClick() {
            gapi.auth2.getAuthInstance().signIn().then(listFiles);
        }

        function handleSignoutClick() {
            gapi.auth2.getAuthInstance().signOut();
            document.getElementById('authorize_button').style.display = 'block';
            document.getElementById('signout_button').style.display = 'none';
            document.getElementById('content').textContent = '';
        }

        function appendPre(message) {
            const pre = document.getElementById('content');
            const textContent = document.createTextNode(message + '\n');
            pre.appendChild(textContent);
        }

        /** List files in specific order */
        function listFiles() {
            document.getElementById('authorize_button').style.display = 'none';
            document.getElementById('signout_button').style.display = 'block';

            gapi.client.drive.files.list({
                'pageSize': 10,
                'fields': "files(id, name, modifiedTime)",
                'orderBy': 'modifiedTime desc' // Change to 'name', 'createdTime', etc.
            }).then(function(response) {
                const files = response.result.files;
                if (!files || files.length === 0) {
                    appendPre('No files found.');
                    return;
                }
                appendPre('Files:');
                files.forEach(function(file) {
                    appendPre(`${file.name} (Modified: ${file.modifiedTime})`);
                });
            });
        }
    </script>
</body>
</html>